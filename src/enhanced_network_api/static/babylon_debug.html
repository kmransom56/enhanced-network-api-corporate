<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babylon.js Debug</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px; 
            font-family: Arial, sans-serif;
            background: #000;
            color: #fff;
        }
        #renderCanvas {
            width: 100%;
            height: 70vh;
            border: 1px solid #333;
        }
        #debug {
            background: #111;
            padding: 10px;
            margin-top: 10px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>Babylon.js Debug Test</h1>
    <canvas id="renderCanvas"></canvas>
    <div id="debug">Debug output will appear here...</div>

    <script>
        const debugDiv = document.getElementById('debug');
        
        function debug(msg) {
            console.log(msg);
            debugDiv.innerHTML += msg + '<br>';
            debugDiv.scrollTop = debugDiv.scrollHeight;
        }
        
        debug('Starting Babylon.js debug test...');
        
        // Check if BABYLON is loaded
        if (typeof BABYLON === 'undefined') {
            debug('ERROR: BABYLON is not defined');
            debug('Loading Babylon.js from CDN...');
            
            const script = document.createElement('script');
            script.src = 'https://cdn.babylonjs.com/babylon.js';
            script.onload = () => {
                debug('Babylon.js loaded successfully');
                initBabylon();
            };
            script.onerror = () => {
                debug('ERROR: Failed to load Babylon.js from CDN');
            };
            document.head.appendChild(script);
        } else {
            debug('Babylon.js already loaded');
            initBabylon();
        }
        
        function initBabylon() {
            try {
                debug('Initializing Babylon.js...');
                
                const canvas = document.getElementById('renderCanvas');
                if (!canvas) {
                    debug('ERROR: Canvas not found');
                    return;
                }
                
                debug('Canvas found: ' + canvas.width + 'x' + canvas.height);
                
                // Create engine
                const engine = new BABYLON.Engine(canvas, true);
                if (!engine) {
                    debug('ERROR: Failed to create engine');
                    return;
                }
                
                debug('Engine created successfully');
                debug('WebGL supported: ' + engine.webGLVersion);
                
                // Create scene
                const scene = new BABYLON.Scene(engine);
                debug('Scene created');
                
                // Create camera
                const camera = new BABYLON.ArcRotateCamera('camera', 0, Math.PI/3, 10, BABYLON.Vector3.Zero(), scene);
                camera.attachControl(canvas, true);
                debug('Camera created');
                
                // Create light
                const light = new BABYLON.HemisphericLight('light', new BABYLON.Vector3(0, 1, 0), scene);
                debug('Light created');
                
                // Create a simple box
                const box = BABYLON.MeshBuilder.CreateBox('testBox', {size: 2}, scene);
                debug('Test box created');
                
                // Start render loop
                engine.runRenderLoop(() => {
                    scene.render();
                });
                
                debug('Render loop started');
                debug('SUCCESS: Babylon.js is working!');
                
                // Handle resize
                window.addEventListener('resize', () => {
                    engine.resize();
                    debug('Canvas resized');
                });
                
            } catch (error) {
                debug('ERROR: ' + error.message);
                debug('Stack: ' + error.stack);
            }
        }
    </script>
</body>
</html>
